<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webtoon Gallery</title>
    <style>
      body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: #f4f4f9; margin: 0; padding: 20px; }
      .container { max-width: 1200px; margin: 0 auto; }
      h1 { text-align: center; color: #333; }
      
      /* [변경] 필터 버튼 스타일 */
      .filter-buttons {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 25px;
      }
      .filter-btn {
        padding: 8px 16px;
        font-size: 14px;
        font-weight: 500;
        border: 1px solid #ddd;
        border-radius: 20px;
        background-color: #fff;
        cursor: pointer;
        transition: all 0.2s;
      }
      .filter-btn:hover {
        background-color: #f0f0f0;
      }
      .filter-btn.active {
        background-color: #007BFF;
        color: white;
        border-color: #007BFF;
      }

      #gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 20px;
      }
      .card { /* 이하 카드 스타일은 이전과 동일 */ }
      /* ... (카드 관련 CSS는 생략, 이전 코드와 동일하게 유지) ... */
      .card { background-color: white; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); overflow: hidden; text-decoration: none; color: inherit; transition: transform 0.2s ease-in-out; display: flex; flex-direction: column; }
      .card:hover { transform: translateY(-5px); }
      .card img { width: 100%; height: 250px; object-fit: cover; background-color: #eee; }
      .card-content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
      .card-content h3 { margin: 0 0 5px 0; font-size: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
      .card-content p { margin: 0; font-size: 12px; color: #777; flex-grow: 1; }
      .card-content .episodes { margin-top: 10px; font-size: 14px; color: #007BFF; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Webtoon Gallery</h1>

        <div class="filter-buttons">
            <button class="filter-btn active" data-min="0" data-max="Infinity">전체</button>
            <button class="filter-btn" data-min="100" data-max="199">100-199화</button>
            <button class="filter-btn" data-min="200" data-max="299">200-299화</button>
            <button class="filter-btn" data-min="300" data-max="399">300-399화</button>
            <button class="filter-btn" data-min="400" data-max="Infinity">400화 이상</button>
        </div>

        <div id="gallery"></div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const jsonUrl = `https://cdn.jsdelivr.net/gh/yusonp/webtoon-assets@master/webtoons.json?v=${new Date().getTime()}`;
        const gallery = document.getElementById('gallery');
        const filterButtons = document.querySelectorAll('.filter-btn');
        let allWebtoons = [];

        // 웹툰 카드를 화면에 그리는 함수
        function renderGallery(webtoons) {
          gallery.innerHTML = '';
          if (webtoons.length === 0) {
            gallery.innerHTML = '<p style="text-align: center;">표시할 웹툰이 없습니다.</p>';
            return;
          }
          webtoons.forEach(webtoon => {
            const card = `
              <a href="${webtoon.url}" target="_blank" class="card">
                <img src="${webtoon.thumbnail}" alt="${webtoon.title}" loading="lazy">
                <div class="card-content">
                  <h3>${webtoon.title}</h3>
                  <p>작가: ${webtoon.author}</p>
                  <p class="episodes">${webtoon.episodes}화</p>
                </div>
              </a>
            `;
            gallery.insertAdjacentHTML('beforeend', card);
          });
        }

        // 각 필터 버튼에 클릭 이벤트 추가
        filterButtons.forEach(button => {
          button.addEventListener('click', function(event) {
            // 모든 버튼에서 'active' 클래스 제거
            filterButtons.forEach(btn => btn.classList.remove('active'));
            // 클릭된 버튼에만 'active' 클래스 추가
            event.currentTarget.classList.add('active');

            const min = parseInt(event.currentTarget.dataset.min, 10);
            const max = parseInt(event.currentTarget.dataset.max, 10);

            const filteredWebtoons = allWebtoons.filter(webtoon => 
              webtoon.episodes >= min && webtoon.episodes <= max
            );
            renderGallery(filteredWebtoons);
          });
        });

        // 최초 데이터 로딩
        fetch(jsonUrl)
          .then(response => response.json())
          .then(webtoons => {
            allWebtoons = webtoons;
            renderGallery(allWebtoons); // 처음에는 모든 웹툰을 보여줌
          })
          .catch(error => {
            console.error('Error fetching webtoon data:', error);
            gallery.innerHTML = '<p style="text-align: center;">데이터를 불러오는 데 실패했습니다. 잠시 후 다시 시도해주세요.</p>';
          });
      });
    </script>
</body>
</html>
